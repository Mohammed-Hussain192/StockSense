<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StockSense - Search Results</title>
    <link rel="stylesheet" href="/styles/search.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <a href="/" class="logo">
            <i class="fas fa-chart-line"></i>StockSense
        </a>
        <ul class="nav-links">
           <a href="/home">Home</a>
            <a href="/market">Markets</a>
            <a href="/watchlist">Watchlist</a>
            <a href="/Profile">Portfolio</a>
           
         
            <a href="/news">News</a>
        </ul>
        <div class="auth-buttons">
            <div class="theme-toggle" id="themeToggle">
                <i class="fas fa-moon toggle-icon"></i>
                <span class="toggle-text">Dark Mode</span>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-container">
        <h1>Search Stocks</h1>

        <form class="search-form" action="/search/stock" method="get">
            <input type="text" name="query" placeholder="Search by symbol or company name" value="<%= query || '' %>" />
            <input type="submit" value="Search" />
        </form>

        <% if (!results || results.length === 0) { %>
            <p class="no-results">No matching stocks found for "<%= query %>"</p>
        <% } else { %>
            <h2 class="results-header">Results for "<%= query %>"</h2>
            <ul class="results-list">
                <% results.forEach(stock => { %>
                    <li class="stock-card">
                        <div class="stock-symbol"><%= stock.price.symbol %></div>
                        <div class="stock-name"><%= stock.price.longName || stock.price.shortName %></div>
                        
                        <div class="stock-detail">
                            <span class="detail-label">Current Price:</span>
                            <span class="detail-value">$<%= stock.price.regularMarketPrice?.fmt || 'N/A' %></span>
                        </div>
                        
                        <div class="stock-detail">
                            <span class="detail-label">Market Cap:</span>
                            <span class="detail-value"><%= stock.price.marketCap?.fmt || 'N/A' %></span>
                        </div>
                        
                        <div class="stock-detail">
                            <span class="detail-label">Exchange:</span>
                            <span class="detail-value"><%= stock.price.exchangeName || 'N/A' %></span>
                        </div>
                        
                        <a href="/stock/<%= stock.price.symbol %>" class="view-link">
                            <i class="fas fa-chart-line"></i> View Details
                        </a>
                    </li>
                <% }) %>
            </ul>
        <% } %>
    </div>

    <script>
        // Theme Toggle Functionality
        const themeToggle = document.getElementById('themeToggle');
        const toggleIcon = themeToggle.querySelector('.toggle-icon');
        const toggleText = themeToggle.querySelector('.toggle-text');

        // Check for saved theme preference or use preferred color scheme
        const currentTheme = localStorage.getItem('theme') || 
                            (window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');

        if (currentTheme === 'light') {
            document.body.classList.add('light-mode');
            toggleIcon.classList.replace('fa-moon', 'fa-sun');
            toggleText.textContent = 'Light Mode';
        }

        themeToggle.addEventListener('click', () => {
            document.body.classList.toggle('light-mode');
            const isLightMode = document.body.classList.contains('light-mode');
            
            if (isLightMode) {
                toggleIcon.classList.replace('fa-moon', 'fa-sun');
                toggleText.textContent = 'Light Mode';
                localStorage.setItem('theme', 'light');
            } else {
                toggleIcon.classList.replace('fa-sun', 'fa-moon');
                toggleText.textContent = 'Dark Mode';
                localStorage.setItem('theme', 'dark');
            }
        });
    </script>
</body>
</html>